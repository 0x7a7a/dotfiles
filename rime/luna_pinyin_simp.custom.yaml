patch:
    # 词库
    translator/dictionary: luna_pinyin_simp.extended
    "speller/algebra/@before 0": xform/^([b-df-hj-np-tv-z])$/$1_/

    # 符号快速上屏
    punctuator:
        import_preset: symbols
        half_shape:
            "#": "#"
            "`": "`"
            "~": "~"
            "@": "@"
            "=": "="
            "/": ["/", "÷"]
            '\': ["、", '\']
            "'": { pair: ["「", "」"] }
            "[": ["【", "["]
            "]": ["】", "]"]
            "$": ["¥", "$", "€", "£", "¢", "¤"]
            "<": ["《", "〈", "«", "<"]
            ">": ["》", "〉", "»", ">"]
    recognizer:
        patterns:
            email: "^[A-Za-z][-_.0-9A-Za-z]*@.*$"
            uppercase: "[A-Z][-_+.'0-9A-Za-z]*$"
            url: "^(www[.]|https?:|ftp[.:]|mailto:|file:).*$|^[a-z]+[.].+$"
            punct: "^/([a-z]+|[0-9]0?)$"

    switches:
        - name: ascii_mode
          reset: 0
          states: ["中文", "西文"]
        - name: full_shape
          states: ["半角", "全角"]
        - name: extended_charset #生僻字开关
          states: ["通用", "增廣"]
        - name: zh_simp
          reset: 1
          states: ["漢字", "汉字"]
        - name: ascii_punct
          states: ["。，", "．，"]

    simplifier:
        option_name: zh_simp

    engine:
        processors:
            - ascii_composer
            - recognizer
            - key_binder
            - speller
            - punctuator
            - selector
            - navigator
            - express_editor
        segmentors:
            - ascii_segmentor
            - matcher
            - abc_segmentor
            - punct_segmentor
            - fallback_segmentor
        translators:
            - punct_translator
            - table_translator@custom_phrase
            - reverse_lookup_translator
            - script_translator
        filters:
            - simplifier
            - uniquifier
            - cjk_minifier #過濾拼音輸入法中的罕用字
    translator:
        enable_charset_filter: true #启用罕见字過濾

    # 模糊拼音
    "speller/algebra":
        - erase/^xx$/ # 第一行保留

        # 模糊音定義先於簡拼定義，方可令簡拼支持以上模糊音
        - abbrev/^([a-z]).+$/$1/ # 簡拼（首字母）
        - abbrev/^([zcs]h).+$/$1/ # 簡拼（zh, ch, sh）

        # 以下是一組容錯拼寫，《漢語拼音》方案以前者爲正
        - derive/^([nl])ve$/$1ue/ # nve = nue, lve = lue
        - derive/^([jqxy])u/$1v/ # ju = jv,
        - derive/un$/uen/ # gun = guen,
        - derive/ui$/uei/ # gui = guei,
        - derive/iu$/iou/ # jiu = jiou,

        # 自動糾正一些常見的按鍵錯誤
        - derive/([aeiou])ng$/$1gn/ # dagn => dang
        - derive/([dtngkhrzcs])o(u|ng)$/$1o/ # zho => zhong|zhou
        - derive/ong$/on/ # zhonguo => zhong guo
        - derive/ao$/oa/ # hoa => hao
        - derive/([iu])a(o|ng?)$/a$1$2/ # tain => tian
